# 🏸 羽球非同步輪替系統 (Badminton Scheduler)

因為抽籤分組太麻煩了，所以寫了一套分組系統測試看看能不能增加分組效率，這套系統可以確保每個人上場次數盡量平均。

## 🌟 主要功能

App URL:
https://rainman5042-badminton-scheduler-app-nihn9q.streamlit.app/

### 1. 智慧輪替與配對 (Smart Matchmaking)
- **非同步換場**：任一場地打完即可結束並換下一組，無需等待其他場地。
- **優先配對**：優先安排「上場次數最少」的球員，確保每個人打球次數平均。
- **實力分組**：支援三種實力分級，並且有防呆配對邏輯：
    - **💀 死亡之組**：高手區，不與休閒組配對。
    - **😓 有點累組**：中階區，可包含上下兼容。
    - **☕ 休閒組**：歡樂區，不與死亡之組配對。
    - *系統會自動避免將「死亡之組」與「休閒組」排在同一場。*

### 2. 彈性場地管理
- **動態場地數量**：可在側邊欄設定開啟 1 或 2 面場地。
- **手動調度**：
    - 若休息區有人，可直接點擊名字將其手動加入場地空位。
    - 支援手動清空場地（不結算成績）。

### 3. 資料保存 (Auto-Save)
- **自動存檔**：系統會將球員名單、場地狀態與歷史紀錄自動儲存至 `badminton_state.json`。
- **防斷線**：即使不小心關閉網頁或重啟程式，資料都會自動回復。
- **一鍵重置**：側邊欄提供「清除所有紀錄」按鈕，可徹底清空資料重新開始。

## 📘 系統使用說明

### 1. 核心功能
因為抽籤分組太麻煩了，所以寫了一套分組系統測試看看能不能增加分組效率，這套系統可以確保每個人上場次數盡量平均。
戰力分組功能還在測試中)戰力分組功能還在測試中))

### 2. 操作流程
1.  **新增球員**：在左側欄位輸入名字並選擇分組等級。
2.  **管理狀態**：
    -   ✅ **勾選**：代表目前在場邊等待或打球中（Active）。
    -   ⬜ **取消勾選**：代表暫時離開或休息（不會被排入下一場）。
3.  **場地運作 (兩階段模式)**：
    -   ✏️ **編輯模式 (Editing)**：
        -   場地空白或剛換人時。
        -   你可以手動從下方休息區點擊 `➕` 加入特定人員。
        -   也可以點擊場地上的 `❌` 將人移除。
    -   🔒 **對戰模式 (Playing)**：
        -   當場地滿 4 人後，點擊 **「🚀 開始對戰」**。
        -   系統會**鎖定場地**，並自動執行 **「戰力平衡演算法」(測試版本)** 分隊。
4.  **結束換場**：
    -   比賽結束後，點擊 **「⏱️ 結束 & 換下一組」**。
    -   系統會記錄場次，並自動從休息區挑選「打最少場」的人遞補。

---

### 🧠 演算法細節 (Algorithm)

#### 1. 優先配對邏輯 (Matchmaking)
系統如何挑選下一組上場的人？
-   **Rule 1 - 公平性**：永遠優先挑選 **「上場次數最少」** 的球員。
-   **Rule 2 - 隨機性**：若多人場次相同，則隨機挑選，避免固定順位。
-   **Rule 3 - 分組相容性(測試版本)**：
    -   系統建有防呆機制，避免讓 **「死亡之組 (Pro)」** 與 **「休閒組 (Casual)」** 出現在同一場，以免雙方都打得不盡興。

#### 2. 戰力平衡邏輯 (Team Balancing)(測試版本)
當 4 個人選定後，系統如何分隊？
-   系統利用 **權重計算** 來尋找最勢均力敵的組合。
-   **權重設定**：
    -   💀 **死亡之組**: 3 分
    -   �� **有點累組**: 2 分
    -   ☕ **休閒組**: 1 分
-   **運算過程**：
    1.  計算 4 人所有可能的分隊組合 (A+B vs C+D, A+C vs B+D, ...)。
    2.  計算每隊的總權重分 (例如：死亡+休閒 = 3+1 = 4)。
    3.  選擇 **「兩隊分差最小」** 的組合。
    -   *例如：(高手+新手) vs (中手+中手) 往往比 (高手+中手) vs (中手+新手) 更公平。*

## 🚀 如何執行

### 1. 安裝依賴
確保已安裝 Python，並執行以下指令安裝 Streamlit：
```bash
pip install streamlit
```

### 2. 啟動系統
在專案目錄下執行：
```bash
streamlit run app.py
```
啟動後瀏覽器會自動開啟操作介面。

## 📂 專案結構
- `app.py`: 主程式邏輯與介面。
- `badminton_state.json`: 自動生成的資料存檔（請勿手動修改）。

---
Designed for happy badminton queuing! 🏸
